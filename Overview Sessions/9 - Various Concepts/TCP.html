<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.1.5/dist/style.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.6.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.2.3"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.1.5/dist/index.umd.min.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, data) => {
        const {
          Markmap
        } = getMarkmap();
        window.mm = Markmap.create('svg#mindmap', getOptions == null ? void 0 : getOptions(), data);
      })(() => window.markmap,null,{"t":"heading","d":1,"p":{"lines":[0,1]},"v":"TCP :handshake:","c":[{"t":"heading","d":2,"p":{"lines":[2,3]},"v":"Overview","c":[{"t":"list_item","d":4,"p":{"lines":[4,5]},"v":"The <strong>Transmission Control Protocol (TCP)</strong> is a transport protocol that is used <strong>on top of IP</strong> to <strong>ensure reliable transmission of packets</strong>."},{"t":"list_item","d":4,"p":{"lines":[5,6]},"v":"TCP includes <strong>mechanisms</strong> to solve many of the problems that arise from packet-based messaging, such as <strong>lost</strong> packets, <strong>out of order</strong> packets, <strong>duplicate</strong> packets, and <strong>corrupted</strong> packets."},{"t":"list_item","d":4,"p":{"lines":[6,7]},"v":"Since TCP is the protocol used most commonly on top of IP, the Internet protocol stack is sometimes referred to as <strong>TCP/IP</strong>."}]},{"t":"heading","d":2,"p":{"lines":[8,9]},"v":"Packet Format","c":[{"t":"bullet_list","d":3,"p":{"lines":[10,14]},"v":"","c":[{"t":"list_item","d":4,"p":{"lines":[10,11]},"v":"When sending packets using TCP/IP, the <strong>data portion</strong> of each IP packet is formatted as a <strong>TCP segment</strong>."},{"t":"list_item","d":4,"p":{"lines":[11,13]},"v":"Diagram of a <strong>TCP segment within an IP packet</strong>. The IP packet contains <strong>header</strong> and <strong>data</strong> sections.<br>\n<br/>"}]},{"t":"bullet_list","d":3,"p":{"lines":[18,22]},"v":"","c":[{"t":"list_item","d":4,"p":{"lines":[18,19]},"v":"The <strong>IP data</strong> section is the <strong>TCP segment</strong>, which itself contains <strong>header</strong> and <strong>data</strong> sections."},{"t":"list_item","d":4,"p":{"lines":[19,20]},"v":"The TCP header contains many <strong>more fields</strong> than a <strong>UDP header</strong> and can range in size from <strong>202020</strong> to <strong>606060 bytes</strong>, depending on the size of the <strong>options</strong> field."},{"t":"list_item","d":4,"p":{"lines":[20,21]},"v":"The TCP header shares some fields with the UDP header: <strong>source port</strong> number, <strong>destination port</strong> number, and <strong>checksum</strong>."}]}]},{"t":"heading","d":2,"p":{"lines":[22,23]},"v":"How TCP Works?","c":[{"t":"bullet_list","d":3,"p":{"lines":[25,27]},"v":"","c":[{"t":"list_item","d":4,"p":{"lines":[25,26]},"v":"Let's step through the process of <strong>transmitting a packet with TCP/IP</strong>."}]},{"t":"heading","d":3,"p":{"lines":[27,28]},"v":"Step 1: Establish connection","c":[{"t":"bullet_list","d":4,"p":{"lines":[29,31]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[29,30]},"v":"When two computers want to send data to each other over TCP, they first need to <strong>establish a connection</strong> using a <strong>three-way handshake</strong>."}]},{"t":"bullet_list","d":4,"p":{"lines":[37,51]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[37,38]},"v":"The <em>first</em> computer <strong>sends</strong> a packet with the <strong>SYN bit</strong> set to <strong>111</strong> where <em>SYN = &quot;synchronize?&quot;</em>."},{"t":"list_item","d":5,"p":{"lines":[38,39]},"v":"The <em>second</em> computer <strong>sends back</strong> a packet with the <strong>ACK bit</strong> set to <strong>111</strong> where <em>ACK = &quot;acknowledge!&quot;</em> plus the <strong>SYN bit</strong> set to <strong>111</strong>."},{"t":"list_item","d":5,"p":{"lines":[39,40]},"v":"The <em>first</em> computer <strong>replies back</strong> with an <strong>ACK</strong>."},{"t":"list_item","d":5,"p":{"lines":[40,41]},"v":"The <strong>SYN</strong> and <strong>ACK</strong> bits are both part of the TCP header:"},{"t":"list_item","d":5,"p":{"lines":[48,49]},"v":"In fact, the three packets involved in the three-way handshake <strong>do not</strong> typically include any <strong>data</strong>."},{"t":"list_item","d":5,"p":{"lines":[49,50]},"v":"Once the computers are <strong>done</strong> with the handshake, they're ready to <strong>receive packets containing actual data</strong>."}]}]},{"t":"heading","d":3,"p":{"lines":[51,52]},"v":"Step 2: Send packets of data","c":[{"t":"bullet_list","d":4,"p":{"lines":[53,55]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[53,54]},"v":"When a packet of data is sent over TCP, the <em>recipient</em> must always <strong>acknowledge</strong> what they received."}]},{"t":"bullet_list","d":4,"p":{"lines":[61,73]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[61,62]},"v":"The <em>first</em> computer <strong>sends</strong> a <strong>packet with data</strong> and a <strong>sequence number</strong>."},{"t":"list_item","d":5,"p":{"lines":[62,63]},"v":"The <em>second</em> computer <strong>acknowledges</strong> it by setting the <strong>ACK</strong> bit and increasing the acknowledgement number by the <strong>length</strong> of the received data."},{"t":"list_item","d":5,"p":{"lines":[63,64]},"v":"The sequence and acknowledgement numbers are part of the TCP header:"},{"t":"list_item","d":5,"p":{"lines":[71,72]},"v":"Those two numbers help the computers to keep track of which data was <strong>successfully</strong> <strong>received</strong>, which data was <strong>lost</strong>, and which data was <strong>accidentally sent twice</strong>."}]}]},{"t":"heading","d":3,"p":{"lines":[73,74]},"v":"Step 3: Close the connection","c":[{"t":"bullet_list","d":4,"p":{"lines":[75,77]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[75,76]},"v":"<em>Either</em> computer can <strong>close</strong> the connection when they <strong>no longer</strong> want to <strong>send or receive data</strong>."}]},{"t":"bullet_list","d":4,"p":{"lines":[83,87]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[83,84]},"v":"A <em>computer</em> initiates closing the connection by sending a packet with the <strong>FIN bit</strong> set to <strong>1</strong> where <em>FIN = finish</em>."},{"t":"list_item","d":5,"p":{"lines":[84,85]},"v":"The <em>other computer</em> replies with an <strong>ACK</strong> and <strong>another FIN</strong>."},{"t":"list_item","d":5,"p":{"lines":[85,86]},"v":"After one more <strong>ACK</strong> from the <em>initiating computer</em>, the connection is <strong>closed</strong>."}]}]},{"t":"heading","d":3,"p":{"lines":[87,88]},"v":"Detecting lost packets","c":[{"t":"bullet_list","d":4,"p":{"lines":[89,91]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[89,90]},"v":"TCP connections <strong>can detect lost packets</strong> using a <strong>timeout</strong>."}]},{"t":"bullet_list","d":4,"p":{"lines":[97,102]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[97,98]},"v":"After sending off a packet, the <em>sender</em> starts a <strong>timer</strong> and puts the packet in a <strong>retransmission queue</strong>."},{"t":"list_item","d":5,"p":{"lines":[98,99]},"v":"If the timer runs out and the sender has <strong>not</strong> yet received an <strong>ACK</strong> from the recipient, it <strong>sends</strong> the <strong>packet</strong> <strong>again</strong>."},{"t":"list_item","d":5,"p":{"lines":[99,100]},"v":"The retransmission may lead to the recipient receiving <strong>duplicate</strong> packets, if a packet was <strong>not</strong> actually lost but just very slow to arrive or be acknowledged."},{"t":"list_item","d":5,"p":{"lines":[100,101]},"v":"If so, the recipient can simply <strong>discard duplicate packets</strong>. It's better to have the data twice than not at all."}]}]},{"t":"heading","d":3,"p":{"lines":[102,103]},"v":"Handling out of order packets","c":[{"t":"bullet_list","d":4,"p":{"lines":[104,106]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[104,105]},"v":"TCP connections <strong>can detect out of order packets</strong> by using the <strong>sequence</strong> and <strong>acknowledgement</strong> numbers."}]},{"t":"bullet_list","d":4,"p":{"lines":[112,134]},"v":"","c":[{"t":"list_item","d":5,"p":{"lines":[112,113]},"v":"When the <em>recipient</em> sees a <strong>higher sequence number</strong> than what they have acknowledged so far, they know that they are <strong>missing</strong> at least one packet in between."},{"t":"list_item","d":5,"p":{"lines":[113,114]},"v":"In the situation pictured above, the recipient sees a <em>sequence number</em> of <strong>#73</strong> but expected a sequence number of <strong>#37</strong>."},{"t":"list_item","d":5,"p":{"lines":[114,115]},"v":"The <em>recipient</em> lets the <em>sender</em> know there's something amiss by sending a packet with an <strong>acknowledgement number set to the expected sequence number</strong>."},{"t":"list_item","d":5,"p":{"lines":[115,116]},"v":"Sometimes the missing packet is simply taking a <em>slower route</em> through the Internet and it arrives soon after."},{"t":"list_item","d":5,"p":{"lines":[123,124]},"v":"Other times, the missing packet may actually be a <strong>lost packet</strong> and the sender must <strong>retransmit</strong> the packet."},{"t":"list_item","d":5,"p":{"lines":[131,132]},"v":"In both situations, the <em>recipient</em> has to <strong>deal</strong> with out of order packets."},{"t":"list_item","d":5,"p":{"lines":[132,133]},"v":"The recipient can use the <strong>sequence numbers</strong> to <strong>reassemble</strong> the packet data in the <strong>correct</strong> order."}]}]}]}]})</script>
</body>
</html>
